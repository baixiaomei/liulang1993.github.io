---
layout: post
title: 浅谈this的用法
description: this作为函数的一个关键字，在JavaScript中占有着很重要的地位，如何理解this在不同情景下的所指，是我们需要去掌握的重要知识
category: blog
---

###首先在介绍`this`的4种情景之前，大家先要在脑海里记住一句话：“`this`只有在被调用(也就是函数被调用)的时候，才能明确的知道`this`到底是指向谁，如果`this`没有被调用，在定义时无法判断`this`的指向”

好了，接下来我们具体讲解一下`this`,这个让我们经常困扰的东西

##`this`作为函数直接调用
![正确写法效果图](/images/vvimg/this-1.png "Title")

上面的例子可以说明函数独立的调用，`this`指向全局`window`，但是如果在严格模式会报错

拓展一下：
也就是普遍看着会觉得绕的地方，重新用函数调用的方式，解释两种情况

1.
![正确写法效果图](/images/vvimg/this-2.png "Title")

相信很多初学者看到这个 `a()()`; 都是比较茫然的，不知道到底指的是什么意思，因为`function b `这个函数只是返回了值，但是没有进行调用，所以如果你最后调用`a`的时候，用的是`a()`，单括号的形式，打印出来的结果如下：

2.
![正确写法效果图](/images/vvimg/this-3.png "Title")

那么呈现出来的效果会是这样

![正确写法效果图](/images/vvimg/this-3.1.png "Title")

打印出来了，`b`函数里面的内容，而不是`b`的打印结果，所以用`a()()`调用的是`b`函数里面的打印结果，否则用单括号的形式打印出来的，是b函数的内容，其实这种情况可以直接写成下面的方式，比较好理解

![正确写法效果图](/images/vvimg/this-4.png "Title")

在定义完b函数以后，直接调用`b()`函数，然后在整个`a()`函数定义完以后，直接调用`a()`函数，这样就能清晰的看到两者直接的结构关系，比较明确的说明了，`this`作为函数直接调用的结果，就是`this === window`

##`this`作为对象的方法来调用
`this`作为对象的方法来调用，有两种情况：

1.直接作为对象的方法来调用的情况

![正确写法效果图](/images/vvimg/this-5.png "Title")

2.将对象的方法引用赋值(引用赋值的3中情况  
`var x = {};
 var x =[] ;
 function x (){} ` 
 )
 给另一个变量，然后独立调用该变量的情况

![正确写法效果图](/images/vvimg/this-6.png "Title")

上面两种情况看起来区别不算大， 但是实际上区别很大
1.直接调用`obj`对象里的`getName`方法，这时，`this`指向的是`obj`
2.将对象的方法引用赋值给另一个变量，然后又独立调用这个变量的时候，这时，`this`指向的是`window`

扩展一下：

1.直接作为对象的方法调用，如果对象的方法里面存在闭包，这时`this`的指向是什么?

![正确写法效果图](/images/vvimg/this-7.png "Title")

这时`getName`方法里面有一个匿名函数（闭包）,二匿名函数的执行环境具有全局性，所以这个时候`this`的指向，就变成了全局，也就是说`this === window`

2.如果出现了上面示例的这种情况，我们需要调用的是`getName`里面匿名函数的作用域，那么我们需要将`this`变量储存起来，保证`this`的指向不会指向全局,因为我们无法改变`this`的值，所以只能将其用变量的方式来使它成为一个局部的变量来调用

![正确写法效果图](/images/vvimg/this-8.png "Title")

这里面也就是在`getName2`方法里面，匿名函数的外面，定义了一个局部变量`that`，用来保存`this`,这样就能将`this`的值控制在`getName2`方法内。

##`this`在构造函数中调用
![正确写法效果图](/images/vvimg/this-9.png "Title")
在构造函数里面，将构造函数的作用域赋给了新对象（也就是`new`出来的实例），因此`this`指向了这个新对象，在执行构造函数中的代码时，也就为这个新对象添加了属性和方法

##使用`call()`,`apply()`,`bind()`调用`this`
###`call()`,`apply()`这两种方式，在调用的时候，他们的第一个参数代表着`this`的指向
![正确写法效果图](/images/vvimg/this-10.png "Title")

放在实际的运算中，可能理解的效果更快一些。
运算效果如下：

![正确写法效果图](/images/vvimg/this-11.png "Title")

`call()`， `apply( )`两种方式就是书写的方式不一样，但是两者的共性就是，他们的第一个参数，代表着`this`的指向，记住这一点即可

###`bind()`方法有一些不一样，它只能用函数表达式的方法来调用，用函数申明的方式会报错

![正确写法效果图](/images/vvimg/this-12.png "Title")

##结语：
以上就是`this`常见的4中用法，始终要记住，`this`只有在调用的时候才能确定它的指向，否则在定义时无法明确`this`的具体指向，如有纰漏请指出，共同进步